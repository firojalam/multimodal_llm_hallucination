##

# Qatar
python bin/generate_hallu_QA/generate_QA_batch_submit.py --input data/image_desc_qa_splits/qatar/qatar_image_desc_qa_dev.jsonl --env_file envs/tanbih-azure-gpt4.1_batch.env --output_dir cached_dir/hallu_QA/qatar/GPT-4.1_batch/dev/ --batch_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_dev.txt

python bin/generate_hallu_QA/generate_QA_retrive_parse_results.py --batch_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_dev.txt --env_file envs/tanbih-azure-gpt4.1_batch.env --output_dir cached_dir/hallu_QA/qatar/GPT-4.1_retrieved_batch/dev --output_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_dev.jsonl --output_error_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_error_batch_dev.jsonl --retrieve True --original_file data/image_desc_qa_splits/qatar/qatar_image_desc_qa_dev.jsonl


python bin/generate_hallu_QA/parse_hallucaiton_data.py --input cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_dev.jsonl --output cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_dev.tsv


python bin/generate_hallu_QA/generate_QA_batch_submit.py --input data/hallucination_exp/qatar/qatar_image_desc_qa_test_100.jsonl --env_file envs/tanbih-azure-gpt4.1_batch.env --output_dir cached_dir/hallu_QA/qatar/GPT-4.1_batch/test/ --batch_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test.txt

python bin/generate_hallu_QA/generate_QA_retrive_parse_results.py --batch_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test.txt --env_file envs/tanbih-azure-gpt4.1_batch.env --output_dir cached_dir/hallu_QA/qatar/GPT-4.1_retrieved_batch/test --output_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test.jsonl --output_error_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_error_batch_test.jsonl --retrieve True --original_file data/hallucination_exp/qatar/qatar_image_desc_qa_test_100.jsonl


##### Step 2
python bin/generate_hallu_QA/generate_QA_batch_correct_submit.py --input cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test.jsonl --env_file envs/tanbih-azure-gpt4.1_batch.env --output_dir cached_dir/hallu_QA/qatar/GPT-4.1_batch/test_step2/ --batch_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test_step2.txt

python bin/generate_hallu_QA/generate_QA_retrive_parse_results_corrected.py --batch_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test_step2.txt --env_file envs/tanbih-azure-gpt4.1_batch.env --output_dir cached_dir/hallu_QA/qatar/GPT-4.1_retrieved_batch/test_step2 --output_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test_step2.jsonl --output_error_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_error_batch_test_step2.jsonl --retrieve True --original_file cached_dir/hallu_QA/qatar/qatar_hallu_qa_generation_batch_test.jsonl



# 1) Generate pairs, rule-based only (fast, no API calls)
python bin/generate_hallu_QA/generate_hallu_pairs.py \
  --input data/image_desc_qa_splits/qatar/qatar_image_desc_qa_test.jsonl \
  --output data_hallucination/qatar_data_pairs.jsonl

# 2) Generate pairs with LLM refinement and multilingual output
#    (requires OPENAI_API_KEY, or Azure settings)
python bin/generate_hallu_QA/generate_hallu_pairs.py \
  --input oasis.jsonl \
  --output pairs.jsonl \
  --use_llm \
  --languages en msa arz ajp

# 3) Score predictions (predictions.jsonl must contain one line per claim_id)
python bin/generate_hallu_QA/generate_hallu_pairs.py score \
  --pairs pairs.jsonl \
  --predictions predictions.jsonl \
  --report report.json
  
########## results/inference files


cached_dir/Qwen2.5-Omni-3B-LoRA-results_merged/
Qwen2.5-Omni-3B-LoRA-results_merged/text/en/qatar/merged_results.jsonl

/alt/llm-benchmarking/exp_multimodal_cultural_alignment/cached_dir/GPT-4.1-zero-shot/text/en/qatar/batch_retrieved.jsonl

/alt/llm-benchmarking/exp_multimodal_cultural_alignment/cached_dir/Gemini-2.5-pro-zero-shot/text/msa/qatar/merged.jsonl

/alt/llm-benchmarking/exp_multimodal_cultural_alignment/cached_dir/GPT-4o-zero-shot/audio/en/qatar/merged_file.jsonl


/alt/llm-benchmarking/exp_multimodal_cultural_alignment/GPT5-chat-zero-shot/text/en/algeria/algeria_image_desc_qa_en_text_response_test.jsonl  
  
  
bash ./scripts/copy_recursive.sh /alt/llm-benchmarking/exp_multimodal_cultural_alignment/cached_dir/GPT5-chat-zero-shot/ results/GPT5-chat-zero-shot/

bash ./scripts/copy_recursive.sh /alt/llm-benchmarking/exp_multimodal_cultural_alignment/cached_dir/Gemini-2.5-pro-zero-shot/ results/Gemini-2.5-pro-zero-shot/   



########

# Submit
python bin/batch_submit.py \
  --input tmp/algeria/algeria_image_desc_qa_test_10.jsonl \
  --env_file envs/tanbih-azure-gpt4.1_batch.env \
  --output_dir cached_dir/tmp/GPT-4.1/text_image/english/algeria/ \
  --batch_file cached_dir/tmp/GPT-4.1/text_image/english/algeria/batch_tracking.json \
  --prompt qaimage \
  --lang_prefix en \
  --max_tokens 2000 \
  --modality "text_image"
  
python bin/fetch_and_merge_results.py \
  --batch_file  cached_dir/tmp/GPT-4.1/text_image/english/algeria/batch_tracking.json \
  --env_file    envs/tanbih-azure-gpt4.1_batch.env \
  --output_dir  cached_dir/tmp/GPT-4.1/text_image/english/algeria/ \
  --output_file cached_dir/tmp/GPT-4.1/text_image/english/algeria/retrieved/batch_retrieved.jsonl \
  --output_error_file cached_dir/tmp/GPT-4.1/text_image/english/algeria/retrieved/batch_error_retrieved.jsonl \
  --retrieve True \
  --original_file tmp/algeria/algeria_image_desc_qa_test_10.jsonl \
  --lang_prefix en \
  --custom_id_sep "::q"
  


python bin/batch_submit.py \
  --input data/image_desc_qa_en_msa_egy_lev_splits_4/qatar/test/batch_translated.jsonl \
  --env_file envs/tanbih-azure-gpt4.1_batch.env \
  --output_dir cached_dir/TF_checking/GPT-4.1/text_image/english/qatar/ \
  --batch_file cached_dir/TF_checking/GPT-4.1/text_image/english/qatar/batch_tracking.json \
  --prompt qaimage \
  --lang_prefix en \
  --max_tokens 2000 \
  --modality "text_image"
  
    
python bin/fetch_and_merge_results.py \
  --batch_file  cached_dir/TF_checking/GPT-4.1/text_image/english/qatar/batch_tracking.json \
  --env_file    envs/tanbih-azure-gpt4.1_batch.env \
  --output_dir  cached_dir/TF_checking/GPT-4.1/text_image/english/qatar/ \
  --output_file cached_dir/TF_checking/GPT-4.1/text_image/english/qatar/retrieved/batch_retrieved.jsonl \
  --output_error_file cached_dir/TF_checking/GPT-4.1/text_image/english/qatar/batch_error_retrieved.jsonl \
  --retrieve True \
  --original_file data/image_desc_qa_en_msa_egy_lev_splits_4/qatar/test/batch_translated.jsonl \
  --lang_prefix en \
  --custom_id_sep "::q"
  

python bin/extract_true_false.py --input cached_dir/TF_checking/GPT-4.1/text_image/english/qatar/retrieved/batch_retrieved.jsonl --output data/qatar_test_true_false.jsonl --stats

  
######## Extend and create new hallucination dataset.
python bin/extend_hallucination/batch_submit.py \
  --input tmp/algeria/algeria_image_desc_qa_test_10.jsonl \
  --env_file envs/tanbih-azure-gpt4.1_batch.env \
  --output_dir cached_dir/tmp/extend_hallu_qa/GPT-4.1/text_image/english/algeria/ \
  --batch_file cached_dir/tmp/extend_hallu_qa/GPT-4.1/text_image/english/algeria/batch_tracking.json \
  --prompt qaimage \
  --lang_prefix en \
  --max_tokens 2000 \
  --modality "text_image"  

python bin/extend_hallucination/fetch_and_merge_results.py \
  --batch_file  cached_dir/tmp/extend_hallu_qa/GPT-4.1/text_image/english/algeria/batch_tracking.json \
  --env_file    envs/tanbih-azure-gpt4.1_batch.env \
  --output_dir  cached_dir/tmp/extend_hallu_qa/GPT-4.1/text_image/english/algeria/ \
  --output_file cached_dir/tmp/extend_hallu_qa/GPT-4.1/text_image/english/algeria/retrieved/batch_retrieved.jsonl \
  --output_error_file cached_dir/tmp/extend_hallu_qa/GPT-4.1/text_image/english/algeria/retrieved/batch_error_retrieved.jsonl \
  --retrieve True \
  --original_file tmp/algeria/algeria_image_desc_qa_test_10.jsonl \
  --lang_prefix en \
  --custom_id_sep "::q"  
  
  
python bin/extract_true_false.py --input cached_dir/tmp/extend_hallu_qa/GPT-4.1/text_image/english/algeria/retrieved/batch_retrieved.jsonl --output data/qatar_test_true_false_10.jsonl --stats


  